var $menubar=function(){var o,c=$('<div class="notepad-menubar"></div>'),r=[],f=-1;return{show:function(t){o=t,function(){for(var t=$('<ul class="menu-title"></ul>'),e=0;e<o.length;e++){var n=$('<li class="title"></li>');n.html(o[e].title),n.attr("data-id",e),t.append(n),n.click(function(t){var e=Number(this.dataset.id);f=-1===f?(r[e].css({display:"inline-block"}),e):f!==e?(r[f].css({display:"none"}),r[e].css({display:"inline-block"}),e):(r[f].css({display:"none"}),-1),t.stopPropagation()}),n.hover(function(){if(-1!==f){var t=Number(this.dataset.id);r[f].css({display:"none"}),r[t].css({display:"inline-block"}),f=t}})}c.append(t)}(),function(){for(var t=0;t<o.length;t++){for(var e=$('<ul class="menus"></ul>'),n=o[t].menuItems,l=0;l<n.length;l++)if("hr"!==n[l].title){var i=$('<li class="menu-item"></li>');if(i.html(n[l].title),i.attr("data-x",t),i.attr("data-y",l),""!==n[l].shortcut){var s=$('<span class="shortcut"></span>');s.html(n[l].shortcut),i.append(s)}n[l].enabled||i.addClass("disabled"),e.append(i),i.click(function(t){if(t.stopPropagation(),!$(this).hasClass("disabled")){var e=this.dataset.x,n=this.dataset.y;r[e].css({display:"none"}),f=-1,o[e].menuItems[n].handler()}})}else{var a=$('<li class="menu-hr"></li>');e.append(a)}e.css({width:o[t].width,left:o[t].left,display:"none"}),c.append(e),r.push(e)}}(),$("body").append(c)},checked:function(t,e,n){var l=d[t].find(".menu-item")[e];n?$(l).prepend($('<span class="checked">✓</span>')[0]):$(l).find(".checked").remove()},enabled:function(t,e,n){var l=d[t].find(".menu-item")[e];n?$(l).removeClass("disabled"):$(l).addClass("disabled")}}}(),$mainContent=function(){var e=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none"></textarea></div>'),n=e.find("textarea"),l={contentHandler:null,wrap:!1};return n.mousedown(function(){0}),n.mouseup(function(){0}),{show:function(t){$.extend(l,t),$("body").append(e),n.trigger("focus")},setFont:function(t){n.css({"font-family":t.family,"font-size":t.size+"pt"}),"斜体"!==t.style?"粗体"!==t.style?"粗偏斜体"!==t.style||n.css({"font-weight":"bold","font-style":"italic"}):n.css({"font-weight":"bold"}):n.css({"font-style":"italic"})}}}();function comList(){var i,l=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),s=l.find(".editor"),a=l.find(".list"),o={container:"",list:[],select:0,width:"200px",isFont:!1,isFontStyle:!1,selectHandler:null};this.show=function(t){var e,n;$.extend(o,t),0!==(n=$(o.container).find(".notepad-com-list")).length&&n.remove(),$(o.container).append(l),l.css({width:o.width}),function(){var t,e,n,l=0;if(o.isFont)for(l=0;l<o.list.length;l++)(t=$('<li class="item"></li>')).css({"font-family":o.list[l]}),a.append(t.html(o.list[l]));else if(o.isFontStyle)for(l=0;l<o.list.length;l++)e=t=$('<li class="item"></li>'),"斜体"!==(n=o.list[l])?"粗体"!==n?"粗偏斜体"!==n||e.css({"font-weight":"bold","font-style":"italic"}):e.css({"font-weight":"bold"}):e.css({"font-style":"italic"}),a.append(t.html(o.list[l]));else for(l=0;l<o.list.length;l++)t=$('<li class="item"></li>'),a.append(t.html(o.list[l]));i=a.find(".item")}(),e=o.select,$(i[e]).addClass("selected"),s.val(o.list[e]),s.select(),a.click(function(t){$(i[o.select]).removeClass("selected"),o.select=o.list.indexOf($(t.target).html()),$(i[o.select]).addClass("selected"),s.val(o.list[o.select]),s.select(),o.selectHandler(o.select)}),s.keyup(function(){var t=0;for(t=0;t<o.list.length&&0!==o.list[t].indexOf(s.val());t++);t!==o.list.length&&(i[t].scrollIntoView({behavior:"smooth",block:"start"}),$(i[o.select]).removeClass("selected"),$(i[t]).addClass("selected"),o.select=t)})}}var $dlgFont=function(){var e=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn" title="关闭">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>字形(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p class="sample-txt">AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),n=e.find(".btn-ok"),l=e.find(".close-btn"),i=e.find(".btn-cancel"),t=e.find(".sample-txt"),s=e.find(".notepad-dlg-titlebar"),a=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],o=["常规","斜体","粗体","粗偏斜体"],d=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],c={family:"Arial",style:"常规",size:"16",okHandler:null};function r(){t.css({"font-family":c.family,"font-size":c.size+"pt"}),"斜体"!==c.style?"粗体"!==c.style?"粗偏斜体"!==c.style||t.css({"font-weight":"bold","font-style":"italic"}):t.css({"font-weight":"bold"}):t.css({"font-style":"italic"})}function f(){e.remove()}return{show:function(t){$.extend(c,t),$("body").append(e),(new comList).show({container:".notepad-dlg-font .font-family",width:"176px",list:a,select:a.indexOf(c.family),isFont:!0,selectHandler:function(t){c.family=a[t],r()}}),(new comList).show({container:".notepad-dlg-font .font-style",width:"132px",list:o,select:o.indexOf(c.style),isFontStyle:!0,selectHandler:function(t){c.style=o[t],r()}}),(new comList).show({container:".notepad-dlg-font .font-size",width:"64px",list:d,select:d.indexOf(c.size),selectHandler:function(t){c.size=d[t],r()}}),r(),e.find(".dialogbox").draggable({handle:s}),l.click(f),i.click(f),n.click(function(){c.okHandler({family:c.family,style:c.style,size:c.size}),f()}),e.click(function(t){t.stopPropagation()})}}}(),fontContent={config:{appContainer:".fontContent"},bShowStatusBar:!1,bWrap:!1,fontFamily:"Arial",fontStype:"常规",fontSize:"16",fontHandler:function(t){fontContent.fontFamily=t.family,fontContent.fontStype=t.style,fontContent.fontSize=t.size,$mainContent.setFont(t)}};$(function(){$menubar.show(fontContent.menuData),$mainContent.show({contentHandler:function(t){$menubar.enabled(1,6,t)}}),$mainContent.setFont({family:fontContent.fontFamily,style:fontContent.fontStype,size:fontContent.fontSize})}),fontContent.menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0}],width:"202px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!0,handler:function(){}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!0,handler:function(){}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!0,handler:function(){}},{title:"删除(L)",shortcut:"Del",enabled:!0,handler:function(){}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!0},{title:"查找下一个(N)",shortcut:"F3",enabled:!0,handler:function(){}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0},{title:"时间/日期(D)",shortcut:"F5",enabled:!0}],width:"218px",left:"80px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0},{title:"字体(F)...",shortcut:"",enabled:!0,handler:function(){$dlgFont.show({family:fontContent.fontFamily,style:fontContent.fontStyle,size:fontContent.fontSize,okHandler:fontContent.fontHandler})}}],width:"156px",left:"160px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0}],width:"138px",left:"240px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0},{title:"查看反馈",shortcut:"",enabled:!0},{title:"关于记事本(A)",shortcut:"",enabled:!0}],width:"166px",left:"320px"}];